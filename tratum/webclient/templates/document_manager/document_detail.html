{% load static %}
<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="https://getbootstrap.com/assets/img/favicons/favicon-32x32.png">
    <title>Tratum</title>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css"
    crossorigin="anonymous">
    <link href="{% static 'css/form.css' %}" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css"
    integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt"
    crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Titillium+Web:300,400" rel="stylesheet">
  </head>

  <body>
    <!--
    <form class="form-signin" method="POST" action="{% url 'document_manager:process' %}" style="max-width: 680px;">
      {% csrf_token %}
      <input type="hidden" name="document" value="{{object.id}}" />
      <div class="text-center mb-4">
        <img class="mb-4" src="https://getbootstrap.com/assets/brand/bootstrap-solid.svg" alt="" width="72" height="72">
        <h1 class="h3 mb-3 font-weight-normal">{{object.name}}</h1>
        <p>Los siguientes campos corresponden a la información necesaria para generar un {{object.name}}</p>
      </div>
      {% for field in object.get_fields %}
        {% include 'document_manager/fields.html' %}     
        {% if field.field_type == field.LIST %}
          {% for field in field.field_group.all %}
            {% include 'document_manager/fields.html' %}
          {% endfor %}      
        {% endif %}        
      {% endfor %}
      <div class="text-center mb-5">
        <p>El {{object.name}} tiene las siguientes secciones o cláusulas, selecciona las que deseas y las que no</p>
      </div>
      {% for s in object.get_sections %}
        <div class="checkbox mb-3">
          <label>
            <input type="checkbox" name="{{s.formated_slug}}" class="section-check" value="{{s.content}}" data-id="{{s.id}}"> {{s.name}}
          </label>
        </div>
        {% for field in s.documentfield_set.all %}
          <div class="form-label-group mb-5 section-field" data-section="{{s.id}}">
            <input name="{{field.formated_slug}}" type="text" id="{{field.formated_slug}}" class="form-control" placeholder="{{field.name}}">
            <label for="{{field.formated_slug}}">{{field.name}}</label>
            {% if field.help_text %}
              <small>{{field.help_text}}</small>
            {% endif %}
            {% if field.youtube_help_video_link %}
              <iframe class="mb-6" width="100%" height="200" src="{{field.youtube_help_video_link}}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
            {% endif %}
          </div>
        {% endfor %}
      {% endfor %}     
      <input type="submit" class="btn btn-lg btn-primary btn-block" name="pdf" value="Descargar" />
      <p class="mt-5 mb-3 text-muted text-center"><a href="/">Volver</a></p>
    </form>
    <script
      src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"></script>
    <script>
      $(document).ready(function(){
        $('.section-field').hide();
        $('.section-check').on('change', function(){
          id = $(this).data('id')
          if($(this).prop('checked')){
            $(`.section-field[data-section="${id}"]`).show()
          } else {
            $(`.section-field[data-section="${id}"]`).hide()
          }
        })
        $('.adder').on('click', function(e){
          e.preventDefault();
          $($(this).parent().clone()).insertAfter($(this).parent())
        });
      })
    </script>
    -->
    <div class="row main">
      <div class="col-md-8 form-col">
          <div class="upform">
            <a href="/" class="col">Regresar</a>
            <form method="POST" action="{% url 'document_manager:process' %}" id="document-form">    
              <input type="hidden" name="document" value="{{object.id}}" />
              {% csrf_token %}
              <div class="upform-header"></div>    
              <div class="upform-main"> 
                {% for field in object.get_fields %}
                  {% include 'document_manager/fields.html' %}     
                  {% if field.field_type == field.LIST %}
                    <div class="list-fields">
                      {% for field in field.field_group.all %}
                        {% include 'document_manager/fields.html' %}
                      {% endfor %}      
                    </div>
                  {% endif %}            
                {% endfor %}
                <div class="sections col mt-5">
                  <h3 class="mb-3">Secciones opcionales disponibles: </h3>
                  {% for s in object.get_sections %}
                    <div class="col">
                      <input type="checkbox" class="section-item mb-3"> {{s.display_name}}</input>
                    </div>
                  {% empty %}
                    <p>Este documento no contiene secciones opcionales</p>
                  {% endfor %}
                </div>                
              </div>
              <div class="upform-footer">
                <button type="submit" class="btn btn-primary btn-lg">Previsualizar</button>
              </div>    
            </form>
          </div>
      </div>
      <div class="col-md-4 p-0">
        <div class="info-col text-center">
          <h1 class="mt-5">{{document.name}}</h1>
          <p class="text-justify mb-5">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
          quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>
          <iframe class="mb-5 " width="480px" height="260" src="https://www.youtube.com/embed/3va2-oIhVNQ" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
          <h4>Notas importantes: </h4>
          <ul class="text-left mt-3">
            <li>Todas las preguntas son obligatorias</li>
            <li>Puedes utilizar las teclas <strong>TAB</strong>, <strong>ENTER</strong>,  <i class="fas fa-arrow-circle-up"></i>  y  <i class="fas fa-arrow-circle-down"></i>  para navegar entre preguntas</li>
            <li>Cada vez que pases de pregunta, se guardará tu progreso automáticamente</li>
            <li>Una vez completes el formulario, podrás ver una previsualización del documento antes de finalizarlo</li>
          </ul>
        </div>
      </div>
    </div>
        
    <div class="modal fade" id="videoModal" tabindex="-1" role="dialog" aria-labelledby="videoModal" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Video explicativo</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    ...
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="loadingModal" tabindex="-1" role="dialog" aria-labelledby="loadingModal" aria-hidden="true">
        <div class="modal-dialog h-100 d-flex flex-column justify-content-center my-0" role="document">
            <div class="modal-content">
                <div class="modal-body">
                  <img src="{% static 'img/loadingCard.gif' %}" width="40px" class="text-center"/>
                  <span class="float-right loading">Procesando formulario...</span> 
                </div>
            </div>
        </div>
    </div>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-scrollTo/2.1.2/jquery.scrollTo.min.js"></script>      
    <script src="{% static 'js/form.js' %}"></script>

  </body>
</html>
